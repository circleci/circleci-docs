= Connect Jira with CircleCI
:page-platform: Cloud
:description: Connecting Jira with CircleCI
:experimental:

Integrate your CI/CD build and deployment status notifications directly into your Jira cards.

Connect your CircleCI jobs with Jira Cloud using:

* The *CircleCI for Jira* app from the link:https://marketplace.atlassian.com/apps/1215946/circleci-for-jira[Atlassian Marketplace]
* The `circleci/jira` orb from the link:https://circleci.com/developer/orbs/orb/circleci/jira[CircleCI orbs registry]

[#installation-steps]
== Installation steps

[#install-the-circleci-for-jira-app]
=== Install the CircleCI for Jira app

. Go to the Atlassian Marketplace to install the link:https://marketplace.atlassian.com/apps/1215946/circleci-for-jira[CircleCI for Jira] app.
+
image::guides:ROOT:jira_circleci_app.png[CircleCI for Jira app in Atlassian Marketplace]

. Install the app in the appropriate Jira Cloud instance. To do this, you must be a link:https://support.atlassian.com/jira-software-cloud/docs/manage-atlassian-marketplace-apps-in-team-managed-projects/[Jira Admin].
+
image::guides:ROOT:jira_install_app.png[Select organization]
+
image::guides:ROOT:jira_review_install.png[Review and confirm app installation]

. Navigate to the link:https://confluence.atlassian.com/upm/viewing-installed-apps-273875714.html[configuration page] by following these steps:
.. Go to link:https://admin.atlassian.com/[the Atlassian admin page].
.. Ensure you have selected the appropriate organization (if you have more than one), and then select menu:Products[].
.. For the appropriate Jira instance, select the ellipsis (image:guides:ROOT:icons/more.svg[more icon, role="no-border"]) icon.
.. In the contextual menu, select menu:Manage Jira apps[].

+
image::guides:ROOT:jira_manage_apps.png[manage apps menu]

. From the *Manage apps* page, click on the *CircleCI for Jira* app under *User-installed apps* to expand the app details and click *Configure*.
+
image::guides:ROOT:jira_expand_app_details.png[Expand App Details]

. Provide your CircleCI Organization ID and allowed audiences.
+
[NOTE]
====
Your CircleCI Organization ID is only needed for the initial setup. You can find it by navigating to menu:Organization Settings[Overview] in the https://app.circleci.com/[CircleCI web app].

This integration authenticates via xref:permissions-authentication:openid-connect-tokens.adoc[OpenID Connect (OIDC)]. By default, the organization ID provided is used for audience validation, but this can be modified, or more can be added.
====
+
image::guides:ROOT:jira_set_organization_id.png[Set the Organization ID on the app Configure page]

[start=6]
. Select *Submit* to save your changes.
+
image::guides:ROOT:jira_submit_changes.png[Set the Organization ID on the app Configure page]
. Now copy your *Web Trigger URL* for use in the next section.
+
image::guides:ROOT:jira_copy_webtrigger_url.png[Copy the Webtrigger URL]

[#configure-the-jira-orb]
=== Configure the Jira orb

The link:https://circleci.com/developer/orbs/orb/circleci/jira[`circleci/jira`] orb is responsible for relaying information about your build or deployment to the CircleCI Jira application.

. Begin by saving the *Web Trigger URL* from the previous section as an _environment variable_. This could be added as a xref:security:set-environment-variable.adoc#set-an-environment-variable-in-a-project[Project Environment Variable] or within a xref:security:set-environment-variable.adoc#set-an-environment-variable-in-a-context[Context]. We recommend naming the variable `JIRA_WEBHOOK_URL`.

. Next, import the Jira orb into your `.circleci/config.yml` file and implement the `jira/notify` command at the _end_ of your build and deployment jobs. Detailed and up-to-date configuration examples can be found on the link:https://circleci.com/developer/orbs/orb/circleci/jira#usage-examples[orb page].

[#view-build-and-deploy-statuses-in-jira]
== View build and deploy statuses in Jira

The link:https://circleci.com/developer/orbs/orb/circleci/jira[`circleci/jira`] orb automatically detects the Jira ticket number from the branch name or commit message. The build or deployment status is then posted to the appropriate Jira ticket. You can view build and deployment information, natively, in the right sidebar of any Jira ticket.

image::guides:ROOT:jira_ticket_sidebar.png[Jira build status]

From this sidebar menu you can click into the build or deployment information to view the full CircleCI job details.

image::guides:ROOT:jira_builds_tab.png[Jira builds tab]
