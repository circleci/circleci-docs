version: 2.1

parameters:
  param1:
    type: boolean
    default: false
  param2:
    type: boolean
    default: false
  param3:
    type: boolean
    default: false
  param4:
    type: boolean
    default: true

jobs:
  test:
    docker:
      - image: cimg/node:19.0.1
    steps:
      - checkout
      - when:
          condition:
            or:
              - and:
                - or:
                    - and:
                        - equal: [ main, << pipeline.git.branch >> ]
                        - equal: [ false, << pipeline.parameters.param1 >> ]
                    - or:
                        - not: << pipeline.parameters.param3 >>
                - or:
                    - equal: [ false, << pipeline.parameters.param3 >> ]
                    - or: [ << pipeline.parameters.param1 >>, << pipeline.parameters.param2 >> ]  
              - or:
                  - equal: [ true, << pipeline.parameters.param4 >> ]

          steps:
            - run: echo "param 4 is true OR the other nested conditions are true"