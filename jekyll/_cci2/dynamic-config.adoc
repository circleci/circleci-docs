---
layout: classic-docs
contentTags:
  platform:
    - Cloud
    - Server v4.x
    - Server v3.x
---
= Dynamic configuration overview
:description: A guide to using CircleCI's dynamic configuration features
:page-layout: classic-docs
:page-liquid:
:icons: font
:experimental:

Dynamic configuration in CircleCI is the process of describing a pipeline in which the work done is in some way dynamically determined. The dynamic configuration itself can be unique to the requirements of your specific project. CircleCI offers a number of features and processes that can be used to create a dynamic configuration that works for you.

Some examples of using dynamic configuration in CircleCI include:

* Optimize pipelines by incorporating logic that checks for file changes or parameter values so that only necessary work is done in each pipeline
* Share common configuration across projects by generating project-specific sections dynamically based on parameters
* _Continue_ a pipeline based on the path of changed files
* Split up a configuration file into reusable fragments that can be dynamically assembled
* Generate full configurations from very small company-specifiic configurations. If you have many repositories with similar CI/CD requirements, you can generate a full CircleCI YAML configuration dynamically from small template configuration that may use another configuration language.
* Generate and run a configuration based on where code has changed.
* If you are working with a language or framework that has its own configuration language, you can generate a CircleCI configuration dynamically from that existing configuration file.

== Quickstart

[#how-dynamic-config-works]
== How dynamic config works

CircleCI's dynamic configuration feature is made up of the following resources that can be used together to fit a variety of use cases:

* CircleCI API v2 link:https://circleci.com/docs/api/v2/index.html#operation/continuePipeline[continue a pipeline] endpoint

Two orbs:

CircleCI Developer Hub - circleci/path-filtering

CircleCI Developer Hub - circleci/continuation

CircleCI's dynamic configuration feature uses setup workflows. A _setup workflow_ can contain jobs that compute pipeline parameters, which can then be passed into an additional configuration that potentially exists in other directories. A setup workflow can also be used to generate new configurations via pre-existing scripts. In any case, the setup workflow continues the pipeline on to the desired next configuration.

Behind the scenes, the _continuation_ configuration is implemented as a call to a public _pipeline continuation_ API. This API accepts a _continuation key_, which is a secret, unique-per-pipeline key that is automatically injected into the environment of jobs executed as part of the initial setup workflow. The API also accepts a configuration string, as well as a set of pipeline parameters.

For a basic example on how to use setup workflows for dynamic configuration generation, see the xref:using-dynamic-configuration#[Using dynamic configuration] how-to guide.

Dynamic configuration can mean:

* The work is determined by values passed in at runtime, _pipeline parameters_
* The configuration file is dynamically generated by the pipeline using a template rather than being static YAML
* Using conditional logic and parameterization to determine the work to be done

Instead of manually creating an individual CircleCI configuration per project, you might prefer in some cases to generate these configurations dynamically, depending on specific xref:pipeline-variables#[Pipeline values] or file paths.

CircleCI's dynamic configuration feature allows you to:

- Execute conditional workflows/commands.
- Pass pipeline parameter values and/or generate additional configuration.
- Trigger separate `config.yml` configurations, which exist outside the default parent `.circleci/` directory.

== Use path filtering for monorepos

This becomes particularly helpful in cases where your team is using a monorepo, or a single repository, as opposed to using multiple repositories to store your code.

For instance, you may want to use dynamic configuration to trigger certain workflows based on which files or subdirectories have changed in your repository. Otherwise, all of your microservices/sub-projects would go through the entirety of your build, test, and deployment processes when any single update is introduced. This scenario is also referred to as _path filtering_.

== Use config splitting for microservices

Another scenario in which you could use dynamic configuration is when your project consists of multiple modules, where each module requires a separate job. These jobs could be stored in multiple files as _fragments_ of a configuration. Instead of using one full `.circleci/config.yml` file, you could use dynamic configuration to combine these individual fragments into a full configuration when a pipeline is triggered. This scenario can also be referred to as _config splitting_.

[#getting-started-with-dynamic-config-in-circleci]
== Getting started with dynamic config in CircleCI

To get started with Dynamic configuration in CircleCI:

. In the *Projects* dashboard from the CircleCI web application, select your project.
. Click the *Project Settings* button in the upper-right corner.
. On the left-hand panel, select *Advanced*.
. Scroll to the *Enable dynamic config using setup workflows* setting, and toggle it to the "on" position, as shown below:
+
NOTE: Projects created **after** December 1st 2023 have dynamic config enabled by default. If this applies to your project, you can skip this step.
+
image:{{site.baseurl}}/assets/img/docs/dynamic-config-enable.png[Enable dynamic config in the UI]
. While the steps above will make the feature available, your static `config.yml` will continue to work as normal. This feature will *not* be used until you add the `setup` key with a value of `true` to that `config.yml`.
+
Adding the key `setup: true` to the top level of your parent configuration file (in the `.circleci/` directory) will designate that `config.yml` as a setup configuration.
. At the end of the `setup` workflow, a `continue` job from the link:https://circleci.com/developer/orbs/orb/circleci/continuation[`continuation` orb] must be called. This does _not_ apply if you want to conditionally execute workflows or steps based on *updates to specified files* ("path filtering"), as described in the xref:using-dynamic-configuration#[Using dynamic configuration] how-to guide.

[NOTE]
====
- The setup phase requires `version: 2.1` or higher.
- A pipeline can only be continued once (that is, a pipeline cannot be continued with another setup configuration).
- A pipeline can only be continued within six hours of its creation.
- The setup configuration can only include one workflow.
- Pipeline parameters submitted at continuation time cannot overlap with pipeline parameters submitted at trigger (setup) time.
- Pipeline parameters declared in the setup configuration must also be declared in the continuation configuration. These parameters can be used at continuation time. For more information, see the xref:pipeline-variables#pipeline-parameters-and-dynamic-configuration[Pipeline values and parameters] page.
====

[#dynamic-config-faqs]
== FAQs

include::../_includes/snippets/faq/dynamic-configuration-faq-snip.adoc[]

[#what-to-read-next]
== Next steps

- A how-to guide for xref:using-dynamic-configuration#[Using dynamic configuration]
- The link:https://circleci.com/developer/orbs/orb/circleci/continuation[`continuation` orb]
- The link:https://circleci.com/docs/api/v2/#operation/continuePipeline[`continuePipeline` API call]
